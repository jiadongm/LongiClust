% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{simulate_functional_data}
\alias{simulate_functional_data}
\title{Simulate Multivariate Functional Data with Two Clusters}
\usage{
simulate_functional_data(
  n1 = 50,
  n2 = 50,
  within_var = 1,
  between_sep = 1,
  start1_mean = 0,
  start1_sd = 0.5,
  end1_mean = 0,
  end1_sd = 0.5,
  start2_mean = 0,
  start2_sd = 0.5,
  end2_mean = 0,
  end2_sd = 0.5,
  n_basis = 50,
  n_grid = 50
)
}
\arguments{
\item{n1}{Integer. Number of observations in cluster 1 (default: 50)}

\item{n2}{Integer. Number of observations in cluster 2 (default: 50)}

\item{within_var}{Numeric. Controls within-group variation via eigenvalue
scaling. Higher values increase variability within each cluster (default: 1.0)}

\item{between_sep}{Numeric. Controls separation between cluster means.
Higher values increase distance between cluster centroids (default: 1.0)}

\item{start1_mean}{Numeric. Mean starting level for cluster 1 (default: 0)}

\item{start1_sd}{Numeric. Standard deviation of starting levels in cluster 1 (default: 0.5)}

\item{end1_mean}{Numeric. Mean ending level for cluster 1 (default: 0)}

\item{end1_sd}{Numeric. Standard deviation of ending levels in cluster 1 (default: 0.5)}

\item{start2_mean}{Numeric. Mean starting level for cluster 2 (default: 0)}

\item{start2_sd}{Numeric. Standard deviation of starting levels in cluster 2 (default: 0.5)}

\item{end2_mean}{Numeric. Mean ending level for cluster 2 (default: 0)}

\item{end2_sd}{Numeric. Standard deviation of ending levels in cluster 2 (default: 0.5)}

\item{n_basis}{Integer. Number of basis functions for functional expansion (default: 50)}

\item{n_grid}{Integer. Number of grid points for discretization (default: 50)}
}
\value{
A list with the following components:
  \item{curves_pop1}{Matrix (n1 x n_grid) of functional observations for cluster 1}
  \item{curves_pop2}{Matrix (n2 x n_grid) of functional observations for cluster 2}
  \item{all_curves}{Matrix ((n1+n2) x n_grid) of all functional observations}
  \item{true_labels}{Vector of length (n1+n2) with true cluster assignments}
  \item{t_grid}{Vector of length n_grid with evaluation points}
  \item{mean1}{Vector of length n_grid with cluster 1 mean function}
  \item{mean2}{Vector of length n_grid with cluster 2 mean function}
  \item{within_sd1}{Numeric. Average standard deviation within cluster 1}
  \item{within_sd2}{Numeric. Average standard deviation within cluster 2}
  \item{mean_diff}{Numeric. RMSE of difference between cluster means}
  \item{separation_ratio}{Numeric. Ratio of between-cluster distance to
    average within-cluster standard deviation. Higher values indicate
    better-separated clusters}
  \item{params}{List of all input parameters}
}
\description{
Generates synthetic multivariate functional data for two clusters with
controlled separation and within-group variation. This function is designed
for testing clustering algorithms on longitudinal omics data, where data
objects are vector-valued functions defined on a common domain.
}
\details{
The function generates functional data using a basis expansion approach:

**Data Generation Model:**
Each functional observation X_i(t) is generated as:
\deqn{X_i(t) = \sum_{j=1}^{n_{basis}} (\sqrt{\theta_j} Z_{ij} + \mu_{kj}) \phi_j(t) + L_i(t)}

where:
\itemize{
  \item \eqn{\phi_j(t) = \sqrt{2} \sin(\pi j t)} are orthonormal basis functions
  \item \eqn{\theta_j = within_var \cdot j^{-2}} are eigenvalues controlling variance
  \item \eqn{Z_{ij} \sim N(0,1)} are random coefficients
  \item \eqn{\mu_{kj}} are cluster-specific mean coefficients
  \item \eqn{L_i(t)} is a linear trend from random start to end level
}

**Cluster Separation:**
The between_sep parameter scales the difference between cluster means:
\deqn{\mu_k = \bar{\mu} + between_sep \cdot (\mu_k^{base} - \bar{\mu})}

where \eqn{\mu_k^{base}} are predefined cluster-specific coefficients and
\eqn{\bar{\mu}} is their average.

**Within-Cluster Variation:**
The within_var parameter controls the eigenvalues, affecting how much
individual curves deviate from their cluster mean. Individual-specific
linear trends add additional within-cluster heterogeneity.

**Use Cases:**
This simulation is particularly useful for:
\itemize{
  \item Testing clustering algorithm performance under various difficulty levels
  \item Evaluating sensitivity to within-cluster variation
  \item Assessing robustness to cluster overlap
  \item Mimicking longitudinal gene expression or biomarker trajectories
}
}
\examples{
\dontrun{
# Scenario 1: Well-separated clusters with low within-group variation
# (Easy clustering problem)
data1 <- simulate_functional_data(
  n1 = 50, n2 = 50,
  within_var = 0.3,
  between_sep = 2.5,
  start1_mean = 2, start1_sd = 0.3,
  end1_mean = 0, end1_sd = 0.3,
  start2_mean = 0, start2_sd = 0.3,
  end2_mean = 4, end2_sd = 0.3
)
cat("Separation ratio:", data1$separation_ratio, "\n")

# Scenario 2: High within-group variation with good separation
# (Moderate difficulty)
data2 <- simulate_functional_data(
  within_var = 2.0,
  between_sep = 2.5,
  start1_mean = 2, start1_sd = 0.5,
  end1_mean = 0, end1_sd = 0.5,
  start2_mean = 0, start2_sd = 0.5,
  end2_mean = 4, end2_sd = 0.5
)

# Scenario 3: Overlapping clusters with low within-group variation
# (Difficult due to overlap)
data3 <- simulate_functional_data(
  within_var = 0.3,
  between_sep = 1.0,
  start1_mean = 2, start1_sd = 0.3,
  end1_mean = 0, end1_sd = 0.3,
  start2_mean = 0, start2_sd = 0.3,
  end2_mean = 1, end2_sd = 0.3
)

# Scenario 4: High within-variation and low separation
# (Very difficult clustering problem)
data4 <- simulate_functional_data(
  within_var = 2.0,
  between_sep = 1.0
)

# Multivariate functional data (d0 = 3 variables)
data_mv <- simulate_multivariate_functional_data(
  d0 = 3,
  n1 = 40, n2 = 60,
  within_var = 1.0,
  between_sep = 1.5
)
}

}
\references{
Delaigle, A., Hall, P., & Bathia, N. (2012). Componentwise classification
and clustering of functional data. Biometrika, 99(2), 299-313.

Jacques, J., & Preda, C. (2014). Model-based clustering for multivariate
functional data. Computational Statistics & Data Analysis, 71, 92-106.
}
\seealso{
\code{\link{plot_functional_data}} for visualization
\code{\link{simulate_multivariate_functional_data}} for multivariate version
}
